<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>hicopk2 - Developer Portfolio</title>
    <!-- Load Tailwind CSS from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter font for clean typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the Gold & Black theme */
        body {
            font-family: 'Inter', sans-serif;
        }
        .card {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .social-link {
            transition: all 0.3s ease-in-out;
        }
        .social-link:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.4); /* Gold glow */
        }
        .repo-card:hover {
            transform: scale(1.02);
        }
        /* Style for the loading spinner */
        .spinner {
            border-top-color: #fdd835; /* Amber-500 */
            border-right-color: transparent;
            border-bottom-color: #fdd835;
            border-left-color: transparent;
        }
    </style>
</head>
<body class="min-h-screen bg-black text-gray-200 p-4 sm:p-8">

    <!-- Main Content Container -->
    <main class="max-w-4xl mx-auto">

        <!-- Profile Card Section -->
        <div id="profile-card" class="card bg-gray-900 mb-8 p-6 rounded-xl grid md:grid-cols-3 gap-6 items-center border-t-4 border-amber-500">
            <!-- Content will be injected here by JavaScript -->
            <div class="col-span-3 text-center py-10">
                <div class="inline-block w-8 h-8 border-4 border-solid rounded-full animate-spin spinner"></div>
                <p class="mt-3 text-gray-400">Loading profile data...</p>
            </div>
        </div>

        <!-- Social Media Links Section -->
        <div class="card bg-gray-900 mb-8 p-6 rounded-xl">
            <h2 class="text-2xl font-bold mb-4 text-center text-amber-400">Connect with Me</h2>
            <div id="social-links-container" class="flex flex-wrap justify-center gap-6">
                <!-- Links will be injected here by JavaScript -->
            </div>
        </div>

        <!-- Repositories Section -->
        <div class="card bg-gray-900 p-6 rounded-xl">
            <h2 class="text-2xl font-bold mb-6 text-amber-400">Latest Projects (<span id="repo-username-placeholder">...</span>'s Repos)</h2>

            <!-- Loading/Error State -->
            <div id="loading-error-state" class="hidden flex justify-center items-center py-10">
                <!-- Initial loading state -->
            </div>

            <!-- Repository Grid -->
            <div id="repos-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Repo cards will be injected here by JavaScript -->
            </div>
        </div>
    </main>

    <!-- JavaScript and Firebase Configuration -->
    <script type="module">
        // --- Mandatory Firebase Imports and Setup ---
        // These are required to ensure the environment functions correctly.
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        // NOTE: Firestore imports omitted as no persistent data storage is needed for this public profile.

        const GITHUB_USERNAME = 'hicopk2';

        // Set up global Firebase variables
        let app = null;
        let auth = null;
        let userId = null;

        try {
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
            const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};

            if (Object.keys(firebaseConfig).length > 0) {
                app = initializeApp(firebaseConfig, appId);
                auth = getAuth(app);
                
                const authenticate = async () => {
                    try {
                        if (typeof __initial_auth_token !== 'undefined') {
                            await signInWithCustomToken(auth, __initial_auth_token);
                        } else {
                            await signInAnonymously(auth);
                        }
                    } catch(e) {
                        console.error("Firebase auth failed:", e);
                    }
                };

                authenticate();

                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userId = user.uid;
                    } else {
                        userId = crypto.randomUUID(); // Anonymous ID fallback
                    }
                });
            } else {
                userId = crypto.randomUUID();
            }
        } catch (e) {
            console.error("Failed to initialize Firebase:", e);
            userId = crypto.randomUUID();
        }
        // --------------------------------------------

        // --- Configuration for Social Links ---
        // Icons are simple SVG paths for single-file compatibility
        const socialMediaLinks = [
            { 
                name: 'GitHub', 
                url: `https://github.com/${GITHUB_USERNAME}`, 
                icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3.2-1 3.2-2.5 3.2-2.5 0-1.2-.6-1.5-.6-1.5s.4-.8.4-2.5c0-.8-.2-2.3-1.6-3.2 0 0 1.2-1.2 1.2-3.2 0-1.8-1-2.2-1-2.2-1.3-.3-2.6.2-3.4 1-.8-.8-2.1-1.3-3.4-1-.5-.1-1.3-.2-2.2.3 0 0-1.1.4-1.1 2.2 0 2 .9 2 1.2 3.2 0 0-.6.3-.6 1.5s0 1.5 3.2 2.5c-.3.2-.6.5-.8 1l-.5 2h-1l-.5 2h-1l-.5 2z"/></svg>', 
                color: 'hover:text-amber-400' 
            },
            { 
                name: 'LinkedIn', 
                url: 'https://www.linkedin.com/in/hicopk2_mock', 
                icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/><rect width="4" height="12" x="2" y="9"/><circle cx="4" cy="4" r="2"/></svg>', 
                color: 'hover:text-amber-400' 
            },
            { 
                name: 'Twitter / X', 
                url: 'https://twitter.com/hicopk2_mock', 
                icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 4s-.7 2.1-2 3.4c1 1.4 1 3.6 0 5.1-1.4 1.4-3.5 2.1-5.6 2.1-1.2 0-2.3-.3-3.3-.8C8.9 15.6 7 14.5 5.5 13.1c-1.3-1.4-2-3.3-2-5.1 0-1.8.7-3.7 2-5.1C6.9 2 9.5 1 12 1c2.5 0 5.1 1 7.2 2.8 1.3 1.4 2 3.3 2 5.1 0 1.8-.7 3.7-2 5.1-1.4 1.4-3.5 2.1-5.6 2.1z"/></svg>', 
                color: 'hover:text-amber-400' 
            },
            { 
                name: 'Portfolio/Blog', 
                url: 'https://hicopk2.dev', 
                icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8l4 4-4 4"/></svg>', 
                color: 'hover:text-amber-400' 
            },
        ];

        // --- Utility Functions ---

        /** Fetches data with exponential backoff. */
        const fetchWithExponentialBackoff = async (url, options = {}, retries = 3) => {
            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(url, options);
                    if (response.status === 403 && i < retries - 1) {
                        const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        continue;
                    }
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status} (${response.statusText})`);
                    }
                    return await response.json();
                } catch (error) {
                    if (i === retries - 1) throw error;
                    const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }
        };

        /** Renders the social links into the DOM. */
        const renderSocialLinks = () => {
            const container = document.getElementById('social-links-container');
            container.innerHTML = socialMediaLinks.map(link => `
                <a
                    href="${link.url}"
                    target="_blank"
                    rel="noopener noreferrer"
                    title="${link.name}"
                    class="social-link flex items-center justify-center p-3 w-12 h-12 rounded-full
                           bg-gray-800 text-amber-300 ${link.color}"
                >
                    ${link.icon}
                </a>
            `).join('');
        };
        
        /** Fallback handler for avatar image loading errors. */
        const handleImageError = (e) => {
            e.target.onerror = null; 
            e.target.src = 'https://placehold.co/128x128/000/ffd700?text=HP'; 
        };

        /** Renders the main user profile card. */
        const renderProfileCard = (userData) => {
            const cardElement = document.getElementById('profile-card');
            const username = GITHUB_USERNAME;
            const userLocation = userData.location || 'Unknown Location';
            const userBio = userData.bio || 'A passionate developer with no public bio yet.';
            const userName = userData.name || username;

            cardElement.innerHTML = `
                <div class="col-span-1 flex justify-center md:justify-start">
                    <img
                        src="${userData.avatar_url}"
                        alt="${userName} Avatar"
                        class="w-32 h-32 rounded-full object-cover border-4 border-gray-700 shadow-xl"
                        onerror="document.getElementById('profile-img').src = 'https://placehold.co/128x128/000/ffd700?text=HP';"
                        id="profile-img"
                    />
                </div>

                <div class="col-span-2 text-center md:text-left">
                    <h1 class="text-4xl font-extrabold mb-1 text-amber-400">
                        ${userName}
                    </h1>
                    <p class="text-xl text-gray-400 mb-4">@${username}</p>
                    <p class="text-gray-300 italic max-w-lg mx-auto md:mx-0">
                        ${userBio}
                    </p>
                    
                    <div class="flex flex-wrap gap-4 mt-4 justify-center md:justify-start">
                        <!-- MapPin Icon (Simplified SVG) -->
                        <span class="flex items-center text-sm text-gray-400">
                            <svg class="w-4 h-4 mr-1 text-amber-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
                            ${userLocation}
                        </span>
                        <!-- Users Icon (Simplified SVG) -->
                        <span class="flex items-center text-sm text-gray-400">
                            <svg class="w-4 h-4 mr-1 text-amber-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                            ${userData.followers} Followers
                        </span>
                        
                        <a 
                            href="${userData.html_url}" 
                            target="_blank" 
                            rel="noopener noreferrer" 
                            class="flex items-center text-sm text-amber-400 hover:text-amber-300 transition-colors duration-200"
                            title="View GitHub Profile"
                        >
                            <!-- GitHub Icon (Simplified SVG) -->
                            <svg class="w-4 h-4 mr-1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3.2-1 3.2-2.5 3.2-2.5 0-1.2-.6-1.5-.6-1.5s.4-.8.4-2.5c0-.8-.2-2.3-1.6-3.2 0 0 1.2-1.2 1.2-3.2 0-1.8-1-2.2-1-2.2-1.3-.3-2.6.2-3.4 1-.8-.8-2.1-1.3-3.4-1-.5-.1-1.3-.2-2.2.3 0 0-1.1.4-1.1 2.2 0 2 .9 2 1.2 3.2 0 0-.6.3-.6 1.5s0 1.5 3.2 2.5c-.3.2-.6.5-.8 1l-.5 2h-1l-.5 2h-1l-.5 2z"/></svg>
                            Profile
                        </a>
                        
                    </div>
                </div>
            `;
        };

        /** Renders the list of repositories. */
        const renderRepos = (repos) => {
            document.getElementById('repo-username-placeholder').textContent = GITHUB_USERNAME;
            const gridElement = document.getElementById('repos-grid');
            
            gridElement.innerHTML = repos.map(repo => `
                <a
                    href="${repo.html_url}"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="repo-card block p-4 bg-gray-800/50 rounded-lg border border-gray-800
                           transition-all duration-300 ease-in-out
                           hover:bg-gray-800 hover:border-amber-500 group"
                >
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="text-xl font-semibold text-amber-300 truncate">
                            <!-- Link Icon (Simplified SVG) -->
                            <svg class="w-5 h-5 inline-block mr-2 text-amber-400 group-hover:text-amber-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
                            ${repo.name}
                        </h3>
                        <!-- ArrowUpRight Icon (Simplified SVG) -->
                        <svg class="w-5 h-5 text-amber-500 flex-shrink-0 group-hover:text-amber-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 17l10-10"/><path d="M7 7h10v10"/></svg>
                    </div>
                    <p class="text-sm text-gray-400 line-clamp-2">
                        ${repo.description || 'No description provided for this repository.'}
                    </p>
                </a>
            `).join('');
        };
        
        /** Displays loading or error state. */
        const setLoadingState = (isLoading, message = '') => {
            const container = document.getElementById('loading-error-state');
            const grid = document.getElementById('repos-grid');
            
            if (isLoading) {
                grid.classList.add('hidden');
                container.classList.remove('hidden');
                container.innerHTML = `
                    <div class="flex justify-center items-center py-10">
                        <div class="inline-block w-8 h-8 border-4 border-solid rounded-full animate-spin spinner mr-2"></div>
                        <p class="text-gray-400">${message}</p>
                    </div>
                `;
            } else {
                container.classList.add('hidden');
                grid.classList.remove('hidden');
            }

            if (message && !isLoading) {
                 container.classList.remove('hidden');
                 container.innerHTML = `
                    <div class="bg-red-900/50 border border-red-700 text-red-300 p-4 rounded-lg">
                        <p class="font-semibold">Data Error:</p>
                        <p>${message}</p>
                    </div>
                `;
                grid.classList.add('hidden');
            }
        };

        // --- Main Data Fetching Logic ---
        const fetchGitHubData = async () => {
            setLoadingState(true, 'Fetching profile data...');
            
            try {
                // 1. Fetch User Data
                const userUrl = `https://api.github.com/users/${GITHUB_USERNAME}`;
                const userData = await fetchWithExponentialBackoff(userUrl);
                
                renderProfileCard(userData);
                
                // 2. Fetch Repositories (Limit to 6 most recently updated)
                setLoadingState(true, 'Fetching latest repositories...');
                const reposUrl = `https://api.github.com/users/${GITHUB_USERNAME}/repos?sort=updated&per_page=6`;
                const reposData = await fetchWithExponentialBackoff(reposUrl);
                
                renderRepos(reposData.slice(0, 6));

            } catch (e) {
                console.error('Failed to fetch GitHub data:', e);
                const errorMessage = `Failed to load data for @${GITHUB_USERNAME}. Error: ${e.message}. The GitHub API might be rate-limited or the username is incorrect.`;
                
                // Fallback to error message and placeholder cards
                const placeholderData = {
                    name: 'API Error', bio: 'Could not load profile. See error details.', avatar_url: 'https://placehold.co/128x128/000/ffd700?text=HP', html_url: '#', followers: 'N/A', location: 'N/A'
                };
                renderProfileCard(placeholderData);
                setLoadingState(false, errorMessage);
            } finally {
                setLoadingState(false, ''); // Clear loading state
            }
        };

        // --- Initialization ---
        window.onload = function () {
            renderSocialLinks();
            fetchGitHubData();
        };

    </script>
</body>
</html>
